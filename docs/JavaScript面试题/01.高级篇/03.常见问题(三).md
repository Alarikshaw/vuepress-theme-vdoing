---
title: Untitled
date: 2021-03-19 13:37:52
permalink: /pages/635835/
categories:
  - JavaScript面试题
  - 高级篇
tags:
  - JavaScript
  - 面试题
---

## 下面代码中 a 在什么情况下会打印 1？

```javascript
var a = ?;
if(a == 1 && a == 2 && a == 3){
 	console.log(1);
}
```

从该代码当中，不难看出。变量`a`，必然不是一个字面量，比如数值或字符串，因为 `a` 不能同时等于多个值。。

具体的看一看，判断里面的`a == 1 && a == 2 && a == 3`是一个短路逻辑与运算符，那表明左端条件为真的时候方可运行。

所以，`a`的第一个值必然为1才能往下走，但是下一步`a`的值有期望是2。由此可判断，`a`的值或是间接返回值(类型转换后)应该是可以自增长的。

再看判断里面的`==`运算，此类判断在`JavaScript`里面：如果左右两边的类型是不同的，则会根据类型转换规则试图将它们转为同一类型再比较。

那么尝试定义变量`a`为对象，因为使用了`==`运算符（则尝试转换成`Number`），则会调用`a`的`valueOf`和`toString`方法来获得想要的基本类型，此处为`Number`：

```javascript
var a = {
  value: 0,
  valueOf() {
    return ++this.value;
  }
};
```

调取`a`对象，因为`==`运算，则获取`valueOf`方法，获得`1`；且是自增，下一次调用依然满足判断，依此类推，`a == 1 && a == 2 && a == 3`为`true`成立。

此处，使用：

```javascript
var a = {
  value: 0,
  toString() {
    return ++this.value;
  }
};
```

也是可以的；

>  不过如果同时使用，`valueOf`的优先级会更高一点。

